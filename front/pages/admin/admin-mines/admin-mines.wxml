<navigation-bar title="管理界面" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<view class="page-bg">
  <view class="container">
    <!-- 日期选择器 -->
    <view class="date-picker">
      <picker mode="date" start="2023-01-01" end="2030-12-31" fields="day" 
        value="{{dateRange[0]}}" bindchange="onDateChange">
        <view class="date-item">{{dateRange[0]}}</view>
      </picker>
      <text>至</text>
      <picker mode="date" start="2023-01-01" end="2030-12-31" fields="day" 
        value="{{dateRange[1]}}" bindchange="onDateChange">
        <view class="date-item">{{dateRange[1]}}</view>
      </picker>
    </view>

    <!-- AI分析结果 -->
    <view class="analysis-card" wx:if="{{analysis.summary}}">
      <view class="card-title">AI分析建议</view>
      <view class="analysis-content">
        <text>{{analysis.suggestions}}</text>
      </view>
      <view class="summary-stats">
        <view>总班次: {{analysis.summary.total_schedules}}</view>
        <view>总预约: {{analysis.summary.total_reservations}}</view>
        <view>平均上座率: {{analysis.summary.avg_occupancy_rate}}</view>
      </view>
    </view>

    <!-- 统计数据列表 -->
    <view class="stats-list" wx:if="{{statistics.length > 0}}">
      <view class="list-title">班次统计数据</view>
      <view class="stats-item" wx:for="{{statistics}}" wx:key="schedule_id">
        <view class="route-info">
          <text class="route-name">{{item.route_name}}</text>
          <text class="departure-time">{{item.departure_time}}</text>
        </view>
        <view class="stats-details">
          <view>上座率: {{item.occupancy_rate}}</view>
          <view>已签到: {{item.checked_in}}/{{item.total_seats}}</view>
        </view>
      </view>
    </view>

    <!-- 原有功能菜单 -->
    <view class="form-card">
      <view class="action-list">
        <view class="action-item" hover-class="action-hover" bindtap="navigateToReservationDetail">
          <image class="action-icon" src="/images/reserve.png"></image>
          <text class="action-text">预约详情</text>
          <image class="arrow-icon" src="/images/arrow-right.png"></image>
        </view>
        <view class="action-item" hover-class="action-hover" bindtap="navigateToExport">
          <image class="action-icon" src="/images/scan.png"></image>
          <text class="action-text">数据导出</text>
          <image class="arrow-icon" src="/images/arrow-right.png"></image>
        </view>
        <view class="action-item" hover-class="action-hover" bindtap="navigateToBusAdjust">
          <image class="action-icon" src="/images/pen.png"></image>
          <text class="action-text">班车调整</text>
          <image class="arrow-icon" src="/images/arrow-right.png"></image>
        </view>
      </view>
    </view>
  </view>
</view>