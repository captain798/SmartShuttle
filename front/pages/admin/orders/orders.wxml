<!-- 自定义导航栏 -->
<navigation-bar title="预约情况" back="{{false}}" color="black" background="#FFF"></navigation-bar>
<!-- 顶部日期选择器 -->
<view class="date-picker">
  <picker mode="date" value="{{currentDate}}" bindchange="onDateChange">
    <view>{{currentDate}}</view>
  </picker>
</view>

<!-- 班次列表 -->
<view class="schedule-list">
  <block wx:for="{{schedules}}" wx:key="id">
    <view class="schedule-item">
      <view class="info">
        <text>{{item.time}}</text>
        <text>{{item.route}}</text>
        <text>{{item.start}} → {{item.end}}</text>
      </view>
      <view class="actions">
        <button size="mini" bindtap="editSchedule" data-id="{{item.id}}">编辑</button>
        <button size="mini" type="warn" bindtap="deleteSchedule" data-id="{{item.id}}">删除</button>
      </view>
    </view>
  </block>
</view>

<!-- 添加按钮 -->
<button type="primary" bindtap="addSchedule">添加班次</button>

<!-- 添加/编辑班次的弹窗 -->
<view wx:if="{{showDialog}}" class="dialog-mask">
  <!-- 弹窗表单 -->
  <view class="dialog-content">
    <view class="dialog-header">
      <text>{{dialogType === 'add' ? '添加班次' : '编辑班次'}}</text>
      <button class="close-btn" bindtap="closeDialog">×</button>
    </view>
    
    <form bindsubmit="submitForm">
      <!-- 路线选择 -->
      <view class="form-item">
        <text>路线ID</text>
        <input 
          name="route_id" 
          type="number"
          value="{{formData.route_id}}"
          placeholder="请输入路线ID"/>
      </view>
      
      <!-- 发车时间 -->
      <view class="form-item">
        <text>发车时间</text>
        <input 
          name="departure_datetime" 
          type="datetime" 
          value="{{formData.departure_datetime}}"
          placeholder="YYYY-MM-DD HH:MM"/>
      </view>
      
      <!-- 座位数 -->
      <view class="form-item">
        <text>座位数</text>
        <input 
          name="dynamic_capacity" 
          type="number" 
          value="{{formData.dynamic_capacity}}"
          placeholder="请输入座位数"/>
      </view>
      
      <!-- 车牌号 -->
      <view class="form-item">
        <text>车牌号</text>
        <input 
          name="vehicle_plate" 
          value="{{formData.vehicle_plate}}"
          placeholder="请输入车牌号"/>
      </view>
      
      <!-- 司机ID -->
      <view class="form-item">
        <text>司机ID</text>
        <input 
          name="driver_id" 
          type="number"
          value="{{formData.driver_id}}"
          placeholder="请输入司机ID"/>
      </view>
      
      <button form-type="submit" type="primary">提交</button>
    </form>
  </view>
</view>
