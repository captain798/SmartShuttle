<!-- 背景容器 -->
<view class="my-reservation-bg">
  <!-- 自定义导航栏 -->
  <navigation-bar title="预约记录" back="{{false}}" color="black" background="#FFF"></navigation-bar>
  
  <!-- 状态选择器 -->
  <view class="status-filter-container">
    <picker 
      mode="selector" 
      range="{{statusDisplayList}}"
      value="{{selectedStatusIndex}}"
      bindchange="bindStatusChange"
    >
      <view class="status-filter">
        <text class="filter-text">{{statusDisplayList[selectedStatusIndex] || '全部状态'}}</text>
        <image class="filter-icon" src="/assets/images/arrow-down.png"></image>
      </view>
    </picker>
  </view>



  <!-- 预约记录内容容器 -->
  <view class="my-reservation-container content-scroll">
    <!-- 如果有预约记录 -->
    <scroll-view 
      wx:if="{{reservationList.length > 0}}"
      class="reservation-scroll"
      scroll-y="true"
      style="height: calc(100vh - 320rpx); -webkit-overflow-scrolling: touch;"
    >
      <block wx:for="{{reservationList}}" wx:key="id">
        <view class="reservation-card" style="animation-delay: {{index * 120}}ms;">  <!-- 延迟动画 -->
          <!-- 卡片头部 -->
          <view class="card-header">
            <view class="reservation-date-row">
              <text class="reservation-date-icon">⏰</text>
              <text class="reservation-date-text">{{item.reservationTime}}</text>
            </view>
            <!-- 新增状态显示 -->
            <view class="reservation-status">
              <text>状态: {{item.status}}</text> <!-- 这里会自动显示映射后的中文状态 -->
            </view>
          </view>
          <!-- 卡片主体 -->
          <view class="card-body">
            <view class="card-timeline">
              <view class="timeline-dot start"></view>
              <view class="timeline-line"></view>
              <view class="timeline-dot end"></view>
            </view>
            <!-- 新增班次和座位信息 -->
            <view class="schedule-info">
              <view class="info-row">
                <text class="info-label">班次ID:</text>
                <text class="info-content">{{item.scheduleId}}</text>
              </view>
              <view class="info-row">
                <text class="info-label">座位号:</text>
                <text class="info-content">{{item.seatNumber}}</text>
              </view>
              <view class="info-row" wx:if="{{item.priority_used}}">
                <text class="info-label">教师优先:</text>
                <text class="info-content">是</text>
              </view>
            </view>
            <!-- 出发地和目的地 -->
            <view class="location-info">
              <view class="location-row">
                <text class="location-label start-label">出发地</text>
                <text class="location-content">{{item.startLocation}}</text>
              </view>
              <view class="location-row">
                <text class="location-label end-label">目的地</text>
                <text class="location-content">{{item.endLocation}}</text>
              </view>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>
    <!-- 无预约记录 -->
    <view wx:else class="empty-state">
      <text class="empty-text">暂无预约记录</text>
    </view>
  </view>
</view>
